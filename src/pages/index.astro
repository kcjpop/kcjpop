---
import { getCollection } from 'astro:content'

import Base from '../layouts/Base.astro'
const notes = await getCollection('notes')

// Show notes having date first
notes.sort(
  (a, b) =>
    new Date(b.data.date ?? 0).valueOf() - new Date(a.data.date ?? 0).valueOf(),
)

const fmtDate = (d) =>
  [
    d.getFullYear(),
    String(d.getMonth() + 1).padStart(2, '0'),
    String(d.getDate()).padStart(2, '0'),
  ].join('-')
---

<Base>
  <style>
    .social li::marker {
      content: attr(data-emoji) ' ';
    }

    .note {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(30ch, 1fr));
      justify-content: space-between;
    }
  </style>
  <main class="container flow">
    <h2>Hello, I'm Ã‚n.</h2>
    <p>I'm a web developer living in Finland.</p>

    <p>
      <strong>Stuff I (sometimes) enjoy:</strong> bouldering, <a href="/manga"
        >manga</a
      >, cooking noodles, herb planting, Finnish nature.
    </p>

    <h2>Find me on</h2>
    <ul class="social">
      <li data-emoji="ðŸ‘¨â€ðŸ’»">
        <a
          rel="me"
          href="https://github.com/kcjpop"
          title="See my programming projects on Github">Github</a
        >
      </li>
      <li data-emoji="ðŸ¥·">
        <a
          rel="me"
          href="https://www.codewars.com/users/kcjpop"
          title="Sometimes I practice various programming puzzles in different languages on Codewars."
          >Codewars</a
        >
      </li>
      <li data-emoji="ðŸ˜">
        <a
          rel="me"
          href="https://toot.cafe/@kcjpop"
          title="After Musk took over Twitter and destroyed the platform, I migrated to Mastodon."
          >@kcjpop@toot.cafe</a
        >
      </li>
    </ul>

    <h2>Notes</h2>
    <ul>
      {
        notes.map((note) => (
          <li>
            <div class="note">
              <a href={`/notes/${note.slug}`}>{note.id}</a>

              {note.data.date ? (
                <time datetime={note.data.date}>
                  {fmtDate(new Date(note.data.date))}
                </time>
              ) : null}
            </div>
          </li>
        ))
      }
    </ul>
  </main>
</Base>
